# ローカルツールセットアップ（Python / Terraform / Playwright）

develop の pre-push で必要になるツールを「コピペで完結」できる形でまとめます。特に指定がない限り、リポジトリのルート（`/develop/project/ai-agent`）で実行してください。

## 共通前提
- Node/pnpm は既にインストール済みであること（pnpm 10系想定）。
- シェルは bash/zsh を想定。

## Python / ruff / pytest
Python 3.11 と ruff / pytest を用意します。PEP 668 で `--user` が弾かれる環境があるため、pipx でのインストールを推奨します（フックから直接呼べるよう PATH も通します）。

macOS (Homebrew):
```bash
brew install python@3.11 pipx
pipx ensurepath              # ~/.local/bin を PATH へ追加（指示に従ってシェル再読込）
pipx install ruff
pipx install pytest
```

Ubuntu/Debian:
```bash
sudo apt-get update && sudo apt-get install -y python3 python3-venv pipx
pipx ensurepath              # ~/.local/bin を PATH へ追加（指示に従ってシェル再読込）
pipx install ruff
pipx install pytest
```

確認:
```bash
python3 --version   # 3.11 以上を確認
ruff --version
pytest --version
```

補足: pipx が使えない場合は、リポジトリ直下で `python3 -m venv .venv && ./.venv/bin/pip install ruff pytest` を実行し、`export PATH="/develop/project/ai-agent/.venv/bin:$PATH"` をシェルの rc に追加してください。

## Terraform
macOS (Homebrew):
```bash
brew tap hashicorp/tap
brew install hashicorp/tap/terraform
terraform version
```

Ubuntu/Debian:
```bash
T_VERSION=1.8.0
wget https://releases.hashicorp.com/terraform/${T_VERSION}/terraform_${T_VERSION}_linux_amd64.zip
unzip terraform_${T_VERSION}_linux_amd64.zip
sudo mv terraform /usr/local/bin/
terraform version
```

## Playwright ブラウザ
リポジトリのルートで実行:
```bash
pnpm install                    # まだの場合
pnpm exec playwright install --with-deps
pnpm exec playwright --version
```

## まとめ
上記コマンドが通れば、pre-push の全チェック（webのユニット/統合/ビルド、Python lint/test、Terraform fmt/validate、E2E）がローカルで実行できる状態になります。***
